# EPAGES-CS-5 - E-PAGES Coding Standart 5

<h1>Основной стандарт кодирования на JavaScript</h1>

Этот раздел стандарта описывает какие элементы кода следует считать стандартными, необходимыми для обеспечения высокого уровня технического взаимодействия между общим (разделяемым) кодом JavaScript. Основан на <a href="http://javascript.crockford.com/code.html">стандартах Дугласа Крокфорда</a>.

<h2>1. Обзор</h2>
<ul>
    <li>JavaScript файлы</li>
    <li>Оступы</li>
    <li>Длина строки</li>
    <li>Комментарии</li>
    <li>Объявление переменных</li>
    <li>Объявление функций</li>
    <li>Соглашение об именовании</li>
    <li>Операторы</li>
    <li>Пробелы</li>
    <li>Использование JSLint</li>
</ul>

<h2>2. JavaScript файлы</h2>
JavaScript программы должны храниться в файлах с расширением <code>.js</code>.

Код JavaScript не должен быть встроен в HTML файлы, если код не является специфичным для одной сессии. Код в HTML значительно увеличивает вес страницы без возможности смягчения путем кэширования и сжатия.

<code>&lt;script src="filename.js">&lt;/script></code>
тэги должны быть размещены ближе к концу документа на сколько это возможно. Это уменьшает влияние задержек загрузки сценария на другие компоненты страницы.

<h2>3. Оступы</h2>
Отступ равняется четырем пробелам. Использование табов следует избегать. Каждая подчиненная инструкция должна размещаться на следующм уровне вложенности

<h2>4. Длина строки</h2>
Следует избегать строк длиной более 80 символов. Когда инструкция не умещается на одной строке, следует использовать перенос. 

<h2>5. Комментарии</h2>
Комментарии методов и функций должны быть в формате <a href="https://ru.wikipedia.org/wiki/JSDoc">JSDoc</a>.

Следует поддерживать комментарии в актуальном состоянии. Ошибочные комментарии могут сделать программы еще труднее для чтения и понимания.

Следует комментировать смысл логического блока.

Пример плохого комментария:

```javascript
    i = 0; // Установка i в ноль
```

<h2>6. Объявление переменных</h2>
Все переменные должны быть объявлены перед использованием. JavaScript не требует этого, но программу будет проще читать. Так же легче будет обнаружить необъявленные переменные. Использование глобальных переменных должны быть сведены к минимуму.

Оператор <code>var</code> долежн быть первым оператором в теле функции.

Желательно, каждой переменной дать свою собственную строку и комментарий. Они должны быть перечислены в алфавитном порядке, если это возможно.

```javascript
var currentEntry, // currently selected table entry
    level,        // indentation level
    size;         // size of table
```

JavaScript не имеет блочных областей видимости. Все переменные должны быть определены в начале функции.

<h2>7. Объявление функций</h2>
Все функции должны быть объявлены до их использования. Внутренние функции должны следовать после оператора <code>var</code>. Это помогает прояснить, какие переменные включены в область видимости.

Не должно быть пробела между именем функции и левой скобкой <code>(</code>. Должен быть один пробел между <code>)</code> и <code>{</code>. Само тело должно иметь отступ в четыре пробела. <code>}</code> выравнивается с линией, содержащей начало декларации функции.

```javascript
function outer(c, d) {
    var e = c * d;

    function inner(a, b) {
        return (e * a) + b;
    }

    return inner(0, 1);
}  
```

Если литерал функциии является анонимным, то должен быть один пробел между служебным словом и левой скобкой. Если пробел опущен, то может визульно показаться, что имя функции является <code>function</code>.

```javascript
div.onclick = function (e) {
    return false;
};

that = {
    method: function () {
        return this.datum;
    },
    datum: 0
};
```

Использование глобальных функций, должны быть сведены к минимуму.

Когда функция должна быть вызвана немедленно, все выражение вызова должно быть завернуты в скобки, чтоб было очевидно, что возвращаемая величина является результатом функции, а не сама функция.

```javascript
var collection = (function () {
    var keys = [], values = [];

    return {
        get: function (key) {
            var at = keys.indexOf(key);
            if (at >= 0) {
                return values[at];
            }
        },
        set: function (key, value) {
            var at = keys.indexOf(key);
            if (at < 0) {
                at = keys.length;
            }
            keys[at] = key;
            values[at] = value;
        },
        remove: function (key) {
            var at = keys.indexOf(key);
            if (at >= 0) {
                keys.splice(at, 1);
                values.splice(at, 1);
            }
        }
    };
}());
```

<h2>8. Соглашение об именовании</h2>
Имена должны быть сформированы из 26 прописных и строчных букв <code>(A..Z, a..z)</code>, 10 цифр <code>(0..9)</code> и <code>_</code>. Следует избегать использования международных символов. Не используйте $ (знак доллара) или \ (обратная косая черта) в именах.

Не используйте _ (подчеркивание) в качестве первого или последнего символа имени. Это иногда предназначено для обозначения модификаторов.

Переменные и функций должны начинаться со строчной буквы.

Глобальные переменные должны состоять из всех заглавных букв.

<h2>9. Выражения</h2>
<h3>9.1. Простые выражения</h3>
Каждая строка должна содержать не более одной инструкции. В конце каждой инструкции должна быть точка с запятой.

<h3>9.2. Составные выражения</h3>
Составные выражения это выражения, которые содержат списки выражений, заключенных в <code>{}</code> (фигурные скобки).

<ul>
    <li>Подчиненые выражения должны иметь отступ в 4 пробела</li>
    <li><code>{</code> должна быть в конце строки, с которой начинается составной оператор.</li>
    <li><code>}</code> должна быть на новой строке и находиться на уровне строки с оператором.</li>
    <li>Скобки должны использоваться вокруг всех выражений, даже только в одну строку. Это делает легче добавление выражения без случайного внесения ошибок.</li>
</ul>

<h2>10. Пробелы</h2>
Пустые строки улучшают читаемость.
Пробелы должны быть использованы в следующих случаях:

<ul>
    <li>Ключевое слово, за которым следует левая скобка должно быть разделено пробелом.</li>
    <li>Пробел не должен использоваться между значением функции и ее левой скобкой. Это помогает провести различие между ключевыми словами и вызовами функций.</li>
    <li>Все бинарные операторы, за исключением <code>.</code> и <code>(</code> (левая скобка) и <code>[</code> (левая квадратная скобка) должна быть отделена от своих операндов пробелом.</li>
    <li>Пробел не должен разделять унарный оператор и операнд исключением случаев, когда оператор слово, например: <code>TYPEOF</code>.</li>
    <li>Каждая <code>;</code> (точка с запятой) в объявлении <code>for</code> следует отделять пробелом.</li>
    <li>Пробелы должны следовать за каждой <code>,</code> (запятой).</li>
</ul>

<h2>11. Используйте JSLint</h2>
Весь код на JavaScript должен проходить проверку инструментом <a href="http://www.jslint.com/">JSLint</a> с такими настройками:
<ul>
    <li>Asume - a browser</li>
    <li>Tolerate - missing 'use strict' pragma</li>
    <li>Maximum line length = 80</li>
</ul>

<b>Примечание!</b>
Объявить глобальную переменную для JSLint можно так:
```javascript
/*global $, jQuery*/
```
РЕКОМЕНДУЕТСЯ использовать настройки IDE для настройки глобальных переменных на весь проект, вместо прописывания такого комментария в каждом js-файле.

<b>Пример для PhpStorm:</b>
Languages & Frameworks -> JavaScript -> Code Quality Tools -> JSLint
<img src="//habrastorage.org/files/c51/47c/f9d/c5147cf9dcb246b3817521258ab68f71.png"/>

